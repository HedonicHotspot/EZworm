## basic
normfact_Basic[[index]] <- mean(abs(dge_Basic[[index]]$samples[,3] - normfact_actual)/normfact_actual)
## RLE
normfact_DEseq[[index]] <- mean(abs(dge_DEseq[[index]]$samples[,3] - normfact_actual)/normfact_actual)
## TMM
normfact_TMM[[index]] <- mean(abs(dge_TMM[[index]]$samples[,3] - normfact_actual)/normfact_actual)
## RM
normfact_RM[[index]] <- mean(abs(data_RM[[index]]$gene_normfact - normfact_actual)/normfact_actual)
}
FDR_RMplot <- unlist(FDR_RM)
FDR_Basicplot <- unlist(FDR_Basic)
FDR_TMMplot <- unlist(FDR_TMM)
FDR_DEseqplot <- unlist(FDR_DEseq)
TN_RMplot <- unlist(TN_RM)
TN_Basicplot <- unlist(TN_Basic)
TN_TMMplot <- unlist(TN_TMM)
TN_DEseqplot <- unlist(TN_DEseq)
MSE_RMplot <- unlist(MSE_RM) %>% mean()
MSE_Basicplot <- unlist(MSE_Basic) %>% mean()
MSE_TMMplot <- unlist(MSE_TMM) %>% mean()
MSE_DEseqplot <- unlist(MSE_DEseq) %>% mean()
normfact_RMplot <- unlist(normfact_RM)
normfact_Basicplot <- unlist(normfact_Basic)
normfact_TMMplot <- unlist(normfact_TMM)
normfact_DEseqplot <- unlist(normfact_DEseq)
chosen <- c(15,14)  #seq(10, 40, length.out = 4)
#DEprop <- seq(0, .99, length.out = 50)
all_dens <- c(density(data_RM[[15]]$gene_ratios[,1], bw="SJ")[1],
density(data_RM[[16]]$gene_ratios[,1], bw="SJ")[1])
#
xrange <- range( all_dens)
# morecols <- colorRampPalette(c("green", "blue", "purple", "red"))
# mycols <- rev(morecols(3))
# plot(density(data_RM[[1]]$gene_ratios[,1]), col = mycols[1], xlim = xrange, main="")
# abline(v=data_RM[[1]]$ratio_modes[1], col = mycols[1], lty='dashed')
# for (index in chosen) {
#   lines(density(data_RM[[index]]$gene_ratios[,1]), col = mycols[index])
#   abline(v=data_RM[[index]]$ratio_modes[1], col = mycols[index], lty='dashed')
# }
plot(density(data_RM[[16]]$gene_ratios[,1], bw="SJ"), col = "darkgreen", xlim = xrange, ylim = c(0,20), lwd = 2, main="Ratio Approximation for Major Error Point.")
abline(v=data_RM[[16]]$ratio_modes[1], col = "darkgreen", lty='dashed', lwd=2)
lines(density(data_RM[[15]]$gene_ratios[,1], bw="SJ"), col = "red", lwd=2)
abline(v=data_RM[[15]]$ratio_modes[1], col = "red", lty='dashed', lwd=2)
# True null
plot(DEprop, TN_Basicplot, type='o', col="black", lty=1, ylim=c(0,1) )
## RM
points(DEprop, TN_RMplot, col="red")
lines(DEprop, TN_RMplot, col="red")
## DEseq
points(DEprop, TN_DEseqplot, col="blue")
lines(DEprop, TN_DEseqplot, col="blue")
## TMM
points(DEprop, TN_TMMplot, col="green")
lines(DEprop, TN_TMMplot, col="green")
legend("topright", legend=c("Basic", "RM", "DEseq", "TMM"),
col=c("black", "red", "blue", "green"), lty=1, cex=0.8)
#FDR
plot(DEprop, FDR_Basicplot, type='o', col="black", lty=1, ylim=c(0,1), xlab="Proportion of DE Genes", ylab="False Discoveries" )
#RM
points(DEprop, FDR_RMplot, col="red")
lines(DEprop, FDR_RMplot, col="red")
#DEseq
points(DEprop, FDR_DEseqplot, col="blue")
lines(DEprop, FDR_DEseqplot, col="blue")
#TMM
points(DEprop, FDR_TMMplot, col="green")
lines(DEprop, FDR_TMMplot, col="green")
legend("topright", legend=c("Basic", "RM", "DEseq", "TMM"),
col=c("black", "red", "blue", "green"), lty=1, cex=0.8)
# MSE Plot
barplot(c(MSE_Basicplot, MSE_RMplot, MSE_DEseqplot, MSE_TMMplot), names.arg = c("Basic", "RM", "DEseq", "TMM"), col=c("black", "red", "blue", "green"))
# Normfact Plot
plot(DEprop, normfact_Basicplot, type='o', col="black", lty=1, ylim=c(0,.5), main= "Average Percent Difference of Norm Factors from Actual" )
## RM
points(DEprop, normfact_RMplot, col="red")
lines(DEprop, normfact_RMplot, col="red")
## DEseq
points(DEprop, normfact_DEseqplot, col="blue")
lines(DEprop, normfact_DEseqplot, col="blue")
## TMM
points(DEprop, normfact_TMMplot, col="green")
lines(DEprop, normfact_TMMplot, col="green")
legend("topleft", legend=c("Basic", "RM", "DEseq", "TMM"),
col=c("black", "red", "blue", "green"), lty=1, cex=0.8)
# x_dnbinom <- seq(0, 10403, by = 1)
# plot(1-DEprop, pbinom((1-DEprop)*10403, size = 10403, prob = .5)) # Apply dnbinom function
#
# pbinom((1-DEprop[30])*10403, size = 10403, prob = 1-DEprop[30])
# lapply(DEprop, FUN = function(x){pbinom((1-x)*10403, size = 10403, prob = 1-x)})
#
# probs <- ncol(combn(counts[[1]], ))
length(data_RM)
chosen <- c(15,14)  #seq(10, 40, length.out = 4)
#DEprop <- seq(0, .99, length.out = 50)
all_dens <- c(density(data_RM[[16]]$gene_ratios[,1], bw="SJ")[1],
density(data_RM[[17]]$gene_ratios[,1], bw="SJ")[1])
#
xrange <- range( all_dens)
# morecols <- colorRampPalette(c("green", "blue", "purple", "red"))
# mycols <- rev(morecols(3))
# plot(density(data_RM[[1]]$gene_ratios[,1]), col = mycols[1], xlim = xrange, main="")
# abline(v=data_RM[[1]]$ratio_modes[1], col = mycols[1], lty='dashed')
# for (index in chosen) {
#   lines(density(data_RM[[index]]$gene_ratios[,1]), col = mycols[index])
#   abline(v=data_RM[[index]]$ratio_modes[1], col = mycols[index], lty='dashed')
# }
plot(density(data_RM[[16]]$gene_ratios[,1], bw="SJ"), col = "darkgreen", xlim = xrange, ylim = c(0,20), lwd = 2, main="Ratio Approximation for Major Error Point.")
abline(v=data_RM[[16]]$ratio_modes[1], col = "darkgreen", lty='dashed', lwd=2)
lines(density(data_RM[[15]]$gene_ratios[,1], bw="SJ"), col = "red", lwd=2)
abline(v=data_RM[[15]]$ratio_modes[1], col = "red", lty='dashed', lwd=2)
chosen <- c(15,14)  #seq(10, 40, length.out = 4)
#DEprop <- seq(0, .99, length.out = 50)
ok_prop <- 16
prob_prop <- 17
all_dens <- c(density(data_RM[[ok_prop]]$gene_ratios[,1], bw="SJ")[1],
density(data_RM[[prob_prop]]$gene_ratios[,1], bw="SJ")[1])
#
xrange <- range( all_dens)
heightDetails(all_dens)
heightDetails(plot(density(data_RM[[16]]$gene_ratios[,1], bw="SJ")))
chosen <- c(15,14)  #seq(10, 40, length.out = 4)
#DEprop <- seq(0, .99, length.out = 50)
ok_prop <- 16
prob_prop <- 17
all_dens <- c(density(data_RM[[ok_prop]]$gene_ratios[,1], bw="SJ")[1],
density(data_RM[[prob_prop]]$gene_ratios[,1], bw="SJ")[1])
#
xrange <- range( all_dens)
# morecols <- colorRampPalette(c("green", "blue", "purple", "red"))
# mycols <- rev(morecols(3))
# plot(density(data_RM[[1]]$gene_ratios[,1]), col = mycols[1], xlim = xrange, main="")
# abline(v=data_RM[[1]]$ratio_modes[1], col = mycols[1], lty='dashed')
# for (index in chosen) {
#   lines(density(data_RM[[index]]$gene_ratios[,1]), col = mycols[index])
#   abline(v=data_RM[[index]]$ratio_modes[1], col = mycols[index], lty='dashed')
# }
plot(density(data_RM[[16]]$gene_ratios[,1], bw="SJ"), col = "darkgreen", xlim = xrange, lwd = 2, main="Ratio Approximation for Major Error Point.")
abline(v=data_RM[[16]]$ratio_modes[1], col = "darkgreen", lty='dashed', lwd=2)
lines(density(data_RM[[15]]$gene_ratios[,1], bw="SJ"), col = "red", lwd=2)
abline(v=data_RM[[15]]$ratio_modes[1], col = "red", lty='dashed', lwd=2)
plot(density(data_RM[[16]]$gene_ratios[,1], bw="SJ"), col = "darkgreen", xlim = xrange, lwd = 2, main="Ratio Approximation for Major Error Point.")
plot(density(data_RM[[ok_prop]]$gene_ratios[,1], bw="SJ"), col = "darkgreen", xlim = xrange, lwd = 2, main="Ratio Approximation for Major Error Point.")
abline(v=data_RM[[ok_prop]]$ratio_modes[1], col = "darkgreen", lty='dashed', lwd=2)
lines(density(data_RM[[prob_prop]]$gene_ratios[,1], bw="SJ"), col = "red", lwd=2)
abline(v=data_RM[[prob_prop]]$ratio_modes[1], col = "red", lty='dashed', lwd=2)
chosen <- c(15,14)  #seq(10, 40, length.out = 4)
#DEprop <- seq(0, .99, length.out = 50)
ok_prop <- 16
prob_prop <- 17
all_dens <- c(density(data_RM[[ok_prop]]$gene_ratios[,1], bw="SJ")[1],
density(data_RM[[prob_prop]]$gene_ratios[,1], bw="SJ")[1])
#
xrange <- range( all_dens)
# morecols <- colorRampPalette(c("green", "blue", "purple", "red"))
# mycols <- rev(morecols(3))
# plot(density(data_RM[[1]]$gene_ratios[,1]), col = mycols[1], xlim = xrange, main="")
# abline(v=data_RM[[1]]$ratio_modes[1], col = mycols[1], lty='dashed')
# for (index in chosen) {
#   lines(density(data_RM[[index]]$gene_ratios[,1]), col = mycols[index])
#   abline(v=data_RM[[index]]$ratio_modes[1], col = mycols[index], lty='dashed')
# }
plot(density(data_RM[[ok_prop]]$gene_ratios[,1], bw="SJ"), col = "darkgreen", xlim = xrange, lwd = 2, main="Ratio Approximation for Major Error Point.")
abline(v=data_RM[[ok_prop]]$ratio_modes[1], col = "darkgreen", lty='dashed', lwd=2)
lines(density(data_RM[[prob_prop]]$gene_ratios[,1], bw="SJ"), col = "red", lwd=2)
abline(v=data_RM[[prob_prop]]$ratio_modes[1], col = "red", lty='dashed', lwd=2)
chosen <- c(15,14)  #seq(10, 40, length.out = 4)
#DEprop <- seq(0, .99, length.out = 50)
ok_prop <- 17
prob_prop <- 18
all_dens <- c(density(data_RM[[ok_prop]]$gene_ratios[,1], bw="SJ")[1],
density(data_RM[[prob_prop]]$gene_ratios[,1], bw="SJ")[1])
#
xrange <- range( all_dens)
# morecols <- colorRampPalette(c("green", "blue", "purple", "red"))
# mycols <- rev(morecols(3))
# plot(density(data_RM[[1]]$gene_ratios[,1]), col = mycols[1], xlim = xrange, main="")
# abline(v=data_RM[[1]]$ratio_modes[1], col = mycols[1], lty='dashed')
# for (index in chosen) {
#   lines(density(data_RM[[index]]$gene_ratios[,1]), col = mycols[index])
#   abline(v=data_RM[[index]]$ratio_modes[1], col = mycols[index], lty='dashed')
# }
plot(density(data_RM[[ok_prop]]$gene_ratios[,1], bw="SJ"), col = "darkgreen", xlim = xrange, lwd = 2, main="Ratio Approximation for Major Error Point.")
abline(v=data_RM[[ok_prop]]$ratio_modes[1], col = "darkgreen", lty='dashed', lwd=2)
lines(density(data_RM[[prob_prop]]$gene_ratios[,1], bw="SJ"), col = "red", lwd=2)
abline(v=data_RM[[prob_prop]]$ratio_modes[1], col = "red", lty='dashed', lwd=2)
chosen <- c(15,14)  #seq(10, 40, length.out = 4)
#DEprop <- seq(0, .99, length.out = 50)
ok_prop <- 18
prob_prop <- 19
all_dens <- c(density(data_RM[[ok_prop]]$gene_ratios[,1], bw="SJ")[1],
density(data_RM[[prob_prop]]$gene_ratios[,1], bw="SJ")[1])
#
xrange <- range( all_dens)
# morecols <- colorRampPalette(c("green", "blue", "purple", "red"))
# mycols <- rev(morecols(3))
# plot(density(data_RM[[1]]$gene_ratios[,1]), col = mycols[1], xlim = xrange, main="")
# abline(v=data_RM[[1]]$ratio_modes[1], col = mycols[1], lty='dashed')
# for (index in chosen) {
#   lines(density(data_RM[[index]]$gene_ratios[,1]), col = mycols[index])
#   abline(v=data_RM[[index]]$ratio_modes[1], col = mycols[index], lty='dashed')
# }
plot(density(data_RM[[ok_prop]]$gene_ratios[,1], bw="SJ"), col = "darkgreen", xlim = xrange, lwd = 2, main="Ratio Approximation for Major Error Point.")
abline(v=data_RM[[ok_prop]]$ratio_modes[1], col = "darkgreen", lty='dashed', lwd=2)
lines(density(data_RM[[prob_prop]]$gene_ratios[,1], bw="SJ"), col = "red", lwd=2)
abline(v=data_RM[[prob_prop]]$ratio_modes[1], col = "red", lty='dashed', lwd=2)
DEprop
length(DEprop)
length(DEprop[prob_prop])
DEprop[prob_prop]
DEprop
chosen <- c(15,14)  #seq(10, 40, length.out = 4)
#DEprop <- seq(0, .99, length.out = 50)
ok_prop <- 17
prob_prop <- 18
all_dens <- c(density(data_RM[[ok_prop]]$gene_ratios[,1], bw="SJ")[1],
density(data_RM[[prob_prop]]$gene_ratios[,1], bw="SJ")[1])
#
xrange <- range( all_dens)
# morecols <- colorRampPalette(c("green", "blue", "purple", "red"))
# mycols <- rev(morecols(3))
# plot(density(data_RM[[1]]$gene_ratios[,1]), col = mycols[1], xlim = xrange, main="")
# abline(v=data_RM[[1]]$ratio_modes[1], col = mycols[1], lty='dashed')
# for (index in chosen) {
#   lines(density(data_RM[[index]]$gene_ratios[,1]), col = mycols[index])
#   abline(v=data_RM[[index]]$ratio_modes[1], col = mycols[index], lty='dashed')
# }
plot(density(data_RM[[ok_prop]]$gene_ratios[,1], bw="SJ"), col = "darkgreen", xlim = xrange, lwd = 2, main="Ratio Approximation for Major Error Point.")
abline(v=data_RM[[ok_prop]]$ratio_modes[1], col = "darkgreen", lty='dashed', lwd=2)
lines(density(data_RM[[prob_prop]]$gene_ratios[,1], bw="SJ"), col = "red", lwd=2)
abline(v=data_RM[[prob_prop]]$ratio_modes[1], col = "red", lty='dashed', lwd=2)
chosen <- c(15,14)  #seq(10, 40, length.out = 4)
#DEprop <- seq(0, .99, length.out = 50)
ok_prop <- 18
prob_prop <- 19
all_dens <- c(density(data_RM[[ok_prop]]$gene_ratios[,1], bw="SJ")[1],
density(data_RM[[prob_prop]]$gene_ratios[,1], bw="SJ")[1])
#
xrange <- range( all_dens)
# morecols <- colorRampPalette(c("green", "blue", "purple", "red"))
# mycols <- rev(morecols(3))
# plot(density(data_RM[[1]]$gene_ratios[,1]), col = mycols[1], xlim = xrange, main="")
# abline(v=data_RM[[1]]$ratio_modes[1], col = mycols[1], lty='dashed')
# for (index in chosen) {
#   lines(density(data_RM[[index]]$gene_ratios[,1]), col = mycols[index])
#   abline(v=data_RM[[index]]$ratio_modes[1], col = mycols[index], lty='dashed')
# }
plot(density(data_RM[[ok_prop]]$gene_ratios[,1], bw="SJ"), col = "darkgreen", xlim = xrange, lwd = 2, main="Ratio Approximation for Major Error Point.")
abline(v=data_RM[[ok_prop]]$ratio_modes[1], col = "darkgreen", lty='dashed', lwd=2)
lines(density(data_RM[[prob_prop]]$gene_ratios[,1], bw="SJ"), col = "red", lwd=2)
abline(v=data_RM[[prob_prop]]$ratio_modes[1], col = "red", lty='dashed', lwd=2)
DEprop[prob_prop]
DEprop
# True null
plot(DEprop, TN_Basicplot, type='o', col="black", lty=1, ylim=c(0,1) )
## RM
points(DEprop, TN_RMplot, col="red")
lines(DEprop, TN_RMplot, col="red")
## DEseq
points(DEprop, TN_DEseqplot, col="blue")
lines(DEprop, TN_DEseqplot, col="blue")
## TMM
points(DEprop, TN_TMMplot, col="green")
lines(DEprop, TN_TMMplot, col="green")
legend("topright", legend=c("Basic", "RM", "DEseq", "TMM"),
col=c("black", "red", "blue", "green"), lty=1, cex=0.8)
#FDR
plot(DEprop, FDR_Basicplot, type='o', col="black", lty=1, ylim=c(0,1), xlab="Proportion of DE Genes", ylab="False Discoveries" )
#RM
points(DEprop, FDR_RMplot, col="red")
lines(DEprop, FDR_RMplot, col="red")
#DEseq
points(DEprop, FDR_DEseqplot, col="blue")
lines(DEprop, FDR_DEseqplot, col="blue")
#TMM
points(DEprop, FDR_TMMplot, col="green")
lines(DEprop, FDR_TMMplot, col="green")
legend("topright", legend=c("Basic", "RM", "DEseq", "TMM"),
col=c("black", "red", "blue", "green"), lty=1, cex=0.8)
# MSE Plot
barplot(c(MSE_Basicplot, MSE_RMplot, MSE_DEseqplot, MSE_TMMplot), names.arg = c("Basic", "RM", "DEseq", "TMM"), col=c("black", "red", "blue", "green"))
# Normfact Plot
plot(DEprop, normfact_Basicplot, type='o', col="black", lty=1, ylim=c(0,.5), main= "Average Percent Difference of Norm Factors from Actual" )
## RM
points(DEprop, normfact_RMplot, col="red")
lines(DEprop, normfact_RMplot, col="red")
legend("topleft", legend=c("Basic", "RM", "DEseq", "TMM"),
col=c("black", "red", "blue", "green"), lty=1, cex=0.8)
# True null
plot(DEprop, TN_Basicplot, type='o', col="black", lty=1, ylim=c(0,1) )
## RM
points(DEprop, TN_RMplot, col="red")
lines(DEprop, TN_RMplot, col="red")
## DEseq
points(DEprop, TN_DEseqplot, col="blue")
lines(DEprop, TN_DEseqplot, col="blue")
## TMM
points(DEprop, TN_TMMplot, col="green")
lines(DEprop, TN_TMMplot, col="green")
legend("topright", legend=c("Basic", "RM", "DEseq", "TMM"),
col=c("black", "red", "blue", "green"), lty=1, cex=0.8)
#FDR
plot(DEprop, FDR_Basicplot, type='o', col="black", lty=1, ylim=c(0,1), xlab="Proportion of DE Genes", ylab="False Discoveries" )
#RM
points(DEprop, FDR_RMplot, col="red")
lines(DEprop, FDR_RMplot, col="red")
#DEseq
legend("topright", legend=c("Basic", "RM", "DEseq", "TMM"),
col=c("black", "red", "blue", "green"), lty=1, cex=0.8)
# MSE Plot
barplot(c(MSE_Basicplot, MSE_RMplot, MSE_DEseqplot, MSE_TMMplot), names.arg = c("Basic", "RM", "DEseq", "TMM"), col=c("black", "red", "blue", "green"))
# Normfact Plot
plot(DEprop, normfact_Basicplot, type='o', col="black", lty=1, ylim=c(0,.5), main= "Average Percent Difference of Norm Factors from Actual" )
## RM
points(DEprop, normfact_RMplot, col="red")
lines(DEprop, normfact_RMplot, col="red")
## DEseq
points(DEprop, normfact_DEseqplot, col="blue")
lines(DEprop, normfact_DEseqplot, col="blue")
## TMM
points(DEprop, normfact_TMMplot, col="green")
lines(DEprop, normfact_TMMplot, col="green")
legend("topleft", legend=c("Basic", "RM", "DEseq", "TMM"),
col=c("black", "red", "blue", "green"), lty=1, cex=0.8)
normfact_Basicplot
normfact_RMplot
normfact_RM
View(normfact_RM)
normfact_RM[[1]]
data_RM[[18]]$gene_normfact
normfact_actual
chosen <- c(15,14)  #seq(10, 40, length.out = 4)
#DEprop <- seq(0, .99, length.out = 50)
ok_prop <- 17
prob_prop <- 18
all_dens <- c(density(data_RM[[ok_prop]]$gene_ratios[,1], bw="SJ")[1],
density(data_RM[[prob_prop]]$gene_ratios[,1], bw="SJ")[1])
xrange <- range(all_dens)
plot(density(data_RM[[ok_prop]]$gene_ratios[,1], bw="SJ"), col = "darkgreen", xlim = xrange, lwd = 2, main="Ratio Approximation for Major Error Point.")
abline(v=data_RM[[ok_prop]]$ratio_modes[1], col = "darkgreen", lty='dashed', lwd=2)
lines(density(data_RM[[prob_prop]]$gene_ratios[,1], bw="SJ"), col = "red", lwd=2)
abline(v=data_RM[[prob_prop]]$ratio_modes[1], col = "red", lty='dashed', lwd=2)
chosen <- c(15,14)  #seq(10, 40, length.out = 4)
#DEprop <- seq(0, .99, length.out = 50)
ok_prop <- 18
prob_prop <- 19
all_dens <- c(density(data_RM[[ok_prop]]$gene_ratios[,1], bw="SJ")[1],
density(data_RM[[prob_prop]]$gene_ratios[,1], bw="SJ")[1])
xrange <- range(all_dens)
plot(density(data_RM[[ok_prop]]$gene_ratios[,1], bw="SJ"), col = "darkgreen", xlim = xrange, lwd = 2, main="Ratio Approximation for Major Error Point.")
abline(v=data_RM[[ok_prop]]$ratio_modes[1], col = "darkgreen", lty='dashed', lwd=2)
lines(density(data_RM[[prob_prop]]$gene_ratios[,1], bw="SJ"), col = "red", lwd=2)
abline(v=data_RM[[prob_prop]]$ratio_modes[1], col = "red", lty='dashed', lwd=2)
data_RM[ok_prop]
data_RM[[ok_prop]]$ratio_modes
data_RM[[prob_prop]]$ratio_modes
data_RM[[prob_prop]]$gene_normfact
data_RM[[ok_prop]]$gene_normfact
data_RM[[ok_prop-1]]$gene_normfact
chosen <- c(15,14)  #seq(10, 40, length.out = 4)
#DEprop <- seq(0, .99, length.out = 50)
ok_prop <- 18
prob_prop <- 19
all_dens <- c(density(data_RM[[ok_prop]]$gene_ratios[,1], bw="SJ")[1],
density(data_RM[[prob_prop]]$gene_ratios[,1], bw="SJ")[1])
xrange <- range(all_dens)
plot(density(data_RM[[ok_prop]]$gene_ratios[,1], bw="SJ"), col = "darkgreen", xlim = xrange, lwd = 2, main="Ratio Approximation for Major Error Point.")
abline(v=data_RM[[ok_prop]]$ratio_modes[1], col = "darkgreen", lty='dashed', lwd=2)
lines(density(data_RM[[prob_prop]]$gene_ratios[,1], bw="SJ"), col = "red", lwd=2)
abline(v=data_RM[[prob_prop]]$ratio_modes[1], col = "red", lty='dashed', lwd=2)
data_RM[[ok_prop-1]]$gene_normfact
data_RM[[ok_prop]]$gene_normfact
data_RM[[ok_prop]]$ratio_modes
mean(data_RM[[ok_prop]]$ratio_modes)
sum(data_RM[[ok_prop]]$ratio_modes)
data_RM[[ok_prop]]$ratio_modes/max(data_RM[[ok_prop]]$ratio_modes)
mean(ratio_modes) /data_RM[[ok_prop]]$ratio_modes/max(data_RM[[ok_prop]]$ratio_modes)
mean(data_RM[[ok_prop]]$ratio_modes/max(data_RM[[ok_prop]]$ratio_modes)) /data_RM[[ok_prop]]$ratio_modes/max(data_RM[[ok_prop]]$ratio_modes)
data_RM[[ok_prop]]$ratio_modes/max(data_RM[[ok_prop]]$ratio_modes) / mean(data_RM[[ok_prop]]$ratio_modes/max(data_RM[[ok_prop]]$ratio_modes))
normfact_actual
data_RM[[4]]$ratio_modes/max(data_RM[[4]]$ratio_modes) / mean(data_RM[[4]]$ratio_modes/max(data_RM[[4]]$ratio_modes))
normfact_actual
data_RM[[4]]$gene_normfact
DEprop
scaling_fac
data_RM[[4]]$ratio_modes
data_RM[[4]]$ratio_modes/ mean(data_RM[[4]]$ratio_modes)
data_RM[[4]]$ratio_modes
2^data_RM[[4]]$ratio_modes
1/2^data_RM[[4]]$ratio_modes
scaling_fac
data_RM[[4]]$ratio_modes
log(data_RM[[4]]$ratio_modes,2)
?log
log2(data_RM[[4]]$ratio_modes)
data_RM[[4]]$ratio_modes - max(data_RM[[4]]$ratio_modes)
scaling_fac
data_RM[[4]]$ratio_modes
chosen <- c(15,14)  #seq(10, 40, length.out = 4)
#DEprop <- seq(0, .99, length.out = 50)
ok_prop <- 19
prob_prop <- 20
all_dens <- c(density(data_RM[[ok_prop]]$gene_ratios[,1], bw="SJ")[1],
density(data_RM[[prob_prop]]$gene_ratios[,1], bw="SJ")[1])
xrange <- range(all_dens)
plot(density(data_RM[[ok_prop]]$gene_ratios[,1], bw="SJ"), col = "darkgreen", xlim = xrange, lwd = 2, main="Ratio Approximation for Major Error Point.")
abline(v=data_RM[[ok_prop]]$ratio_modes[1], col = "darkgreen", lty='dashed', lwd=2)
lines(density(data_RM[[prob_prop]]$gene_ratios[,1], bw="SJ"), col = "red", lwd=2)
abline(v=data_RM[[prob_prop]]$ratio_modes[1], col = "red", lty='dashed', lwd=2)
# True null
plot(DEprop, TN_Basicplot, type='o', col="black", lty=1, ylim=c(0,1) )
## RM
points(DEprop, TN_RMplot, col="red")
lines(DEprop, TN_RMplot, col="red")
## DEseq
points(DEprop, TN_DEseqplot, col="blue")
lines(DEprop, TN_DEseqplot, col="blue")
## TMM
points(DEprop, TN_TMMplot, col="green")
lines(DEprop, TN_TMMplot, col="green")
legend("topright", legend=c("Basic", "RM", "DEseq", "TMM"),
col=c("black", "red", "blue", "green"), lty=1, cex=0.8)
#FDR
plot(DEprop, FDR_Basicplot, type='o', col="black", lty=1, ylim=c(0,1), xlab="Proportion of DE Genes", ylab="False Discoveries" )
#RM
points(DEprop, FDR_RMplot, col="red")
lines(DEprop, FDR_RMplot, col="red")
#DEseq
points(DEprop, FDR_DEseqplot, col="blue")
lines(DEprop, FDR_DEseqplot, col="blue")
#TMM
points(DEprop, FDR_TMMplot, col="green")
lines(DEprop, FDR_TMMplot, col="green")
legend("topright", legend=c("Basic", "RM", "DEseq", "TMM"),
col=c("black", "red", "blue", "green"), lty=1, cex=0.8)
# MSE Plot
barplot(c(MSE_Basicplot, MSE_RMplot, MSE_DEseqplot, MSE_TMMplot), names.arg = c("Basic", "RM", "DEseq", "TMM"), col=c("black", "red", "blue", "green"))
# Normfact Plot
plot(DEprop, normfact_Basicplot, type='o', col="black", lty=1, ylim=c(0,.5), main= "Average Percent Difference of Norm Factors from Actual" )
## RM
points(DEprop, normfact_RMplot, col="red")
lines(DEprop, normfact_RMplot, col="red")
## DEseq
points(DEprop, normfact_DEseqplot, col="blue")
lines(DEprop, normfact_DEseqplot, col="blue")
## TMM
points(DEprop, normfact_TMMplot, col="green")
lines(DEprop, normfact_TMMplot, col="green")
legend("topleft", legend=c("Basic", "RM", "DEseq", "TMM"),
col=c("black", "red", "blue", "green"), lty=1, cex=0.8)
chosen <- c(15,14)  #seq(10, 40, length.out = 4)
#DEprop <- seq(0, .99, length.out = 50)
ok_prop <- 18
prob_prop <- 19
all_dens <- c(density(data_RM[[ok_prop]]$gene_ratios[,1], bw="SJ")[1],
density(data_RM[[prob_prop]]$gene_ratios[,1], bw="SJ")[1])
xrange <- range(all_dens)
plot(density(data_RM[[ok_prop]]$gene_ratios[,1], bw="SJ"), col = "darkgreen", xlim = xrange, lwd = 2, main="Ratio Approximation for Major Error Point.")
abline(v=data_RM[[ok_prop]]$ratio_modes[1], col = "darkgreen", lty='dashed', lwd=2)
lines(density(data_RM[[prob_prop]]$gene_ratios[,1], bw="SJ"), col = "red", lwd=2)
abline(v=data_RM[[prob_prop]]$ratio_modes[1], col = "red", lty='dashed', lwd=2)
normfact_RMplot
reticulate::repl_python()
packages = c("BiocManager","tidyverse", "ggplot2", "dplyr", "RColorBrewer", "ggthemes", "formattable", "gplots", "readr",  "RColorBrewer", "limma", "edgeR", "Rsubread", "topGO", "circlize", "genefilter")
## Load R and BioConductoR packages
lapply(packages, library, character.only = T)
setwd("~/MEGAsync/bioinformatics/EasyWorm")
genome <- read_file("genome")
gene_predict
gene_predict <- read_table("gene_predict", col_names = FALSE, skip = 1)
View(gene_predict)
tail(gene_predict)
View(gene_predict)
gene_predict[, 110]
# Fetch Gene Predictions
gene_predict <- function() {
predict_url <- "ucmerced.box.com/s/vi5jfxgqccrt99hx6km3q7j2lp1peayn"
download.file(url = predict_url, destfile =  paste0(getwd(),"/gene_predict") )
}
gene_predict <- function() {
predict_url <- "ucmerced.box.com/s/vi5jfxgqccrt99hx6km3q7j2lp1peayn"
download.file(url = predict_url, destfile =  paste0(getwd(),"/gene_predict") )
}
gene_predict()
genome <- function() {
genome_url <- "ucmerced.box.com/s/lsjjdintuinhncjav8oas3jjkwjpuwxh"
download.file(url = genome_url,destfile =  paste0(getwd(),"/genome") )
}
gene_predict <- function() {
predict_url <- "ucmerced.box.com/s/vi5jfxgqccrt99hx6km3q7j2lp1peayn"
# Downloads SAF file from personal Box account
download.file(url = predict_url, destfile =  paste0(getwd(),"/gene_predict.saf") )
}
# Fetch Genome
GET_genome <- function() {
genome_url <- "ucmerced.box.com/s/lsjjdintuinhncjav8oas3jjkwjpuwxh"
download.file(url = genome_url,destfile =  paste0(getwd(),"/genome") )
}
# Fetch Gene Predictions
GETgene_predict <- function() {
predict_url <- "ucmerced.box.com/s/vi5jfxgqccrt99hx6km3q7j2lp1peayn"
# Downloads SAF file from personal Box account
download.file(url = predict_url, destfile =  paste0(getwd(),"/gene_predict.saf") )
}
GET_genome()
GET_genome()
GETgenome <- function() {
getOption('timeout')
options(timeout=500)
genome_url <- "ucmerced.box.com/s/lsjjdintuinhncjav8oas3jjkwjpuwxh"
download.file(url = genome_url,destfile =  paste0(getwd(),"/genome") )
}
GETgenome()
